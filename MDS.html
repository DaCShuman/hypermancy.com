<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Magnitude Dice System</title>

  <!-- Shared site CSS/JS -->
  <link rel="stylesheet" href="/css/mds.css">
  <script src="/js/mds.js" defer></script>

  <style>
    :root { 
      /* keep page accent (same as default, but explicit here) */
      --accent-green: #00ff99;
      --text-primary: #ffffff;
      --accent-purple: #b58cff;
    }

    main { width: 100%; max-width: 100%; }
    header { margin-bottom: 2em; }
    h1 { font-size: 2.5rem; margin-bottom: 0.5em; }
    p  { font-size: 1.1rem; line-height: 1.6; opacity: 0.9; }
    @media (max-width: 768px) { h1 { font-size: 1.8rem; } p { font-size: 1rem; } }

    /* Section (MDS-internal) button bar styling (uses mds.css base, keeps separate hook) */
    nav.button-bar.section-nav {
      display: flex; flex-wrap: wrap; justify-content: center;
      gap: 1em; margin-bottom: 2em;
    }

    /* Power Factors list */
    .power-factors { list-style: none; padding: 0; text-align: left; max-width: 700px; margin: 0 auto; }
    .power-factors li { margin-bottom: .5em; font-size: 1.1rem; }
    .power-factors strong { color: rgb(233, 146, 7); }

    /* Hover-only purple + glow opt-in (site-wide nav visuals) */
    .hover-purple-glow { 
      color: inherit; 
      text-shadow: none; 
      transition: color .2s ease, text-shadow .2s ease;
      outline-offset: 2px;
    }
    a.hover-purple-glow:hover, a.hover-purple-glow:focus-visible { 
      color: var(--accent-purple); 
      text-shadow: 0 0 6px var(--accent-purple); 
    }
    a.hover-purple-glow:focus-visible {
      outline: 2px solid var(--accent-purple);
      outline-offset: 3px;
    }

    /* Site-wide Button bar (index-style; mds.css provides base .button-bar/.nav-btn) */
    nav.button-bar.site-nav { display:flex; flex-wrap:wrap; justify-content:center; gap:1em; margin-bottom:.75em; }

    /* Section nav items - add focus styling */
    nav.button-bar.section-nav a {
      outline-offset: 2px;
    }
    nav.button-bar.section-nav a:focus-visible {
      outline: 2px solid var(--accent-purple);
      outline-offset: 3px;
    }

    /* Expanding description panel under navs */
    .bar-explain {
      position: relative;
      margin: 0 auto 1.5rem;
      max-width: 900px;
      color: var(--text-primary);
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 12px;
      padding: 0 1.1rem;
      overflow: clip;
      backdrop-filter: blur(10px);

      /* collapsed state */
      max-height: 0;
      opacity: 0;
      transform: translateY(-6px) scaleY(.98);
      transform-origin: top;
      transition: max-height .35s ease, opacity .25s ease, transform .35s ease, padding .25s ease;
      will-change: max-height, opacity, transform;
    }
    .bar-explain.show {
      max-height: 220px;
      opacity: 1;
      transform: translateY(0) scaleY(1);
      padding: .85rem 1.1rem 1rem;
    }
    .bar-explain p { margin: 0; font-size: 1rem; line-height: 1.55; text-align: center; }

    .scribble-frame {
      position: absolute; inset: -8px;
      width: calc(100% + 16px); height: calc(100% + 16px);
      pointer-events: none; opacity: .55;
    }
    .scribble-frame path {
      fill:none; stroke: rgba(181,140,255,.55); stroke-width:2;
      stroke-linecap:round; stroke-linejoin:round;
      filter: drop-shadow(0 0 6px rgba(181,140,255,.25));
    }
  </style>
</head>

<body>
  <main>
    <!-- Site-wide NAV (matches Index) -->
    <header>
      <nav class="button-bar site-nav" id="buttonBar" data-explain-target="barExplain">
        <a href="Index.html" class="hover-purple-glow nav-item"
           data-desc="Return to the Hypermancy Studios homepage.">
          Hypermancy Studios
        </a>
        <a href="PoP.html" class="hover-purple-glow nav-item"
           data-desc="Explore Paths of Power â€” the living universe and its grand campaign.">
          Paths of Power
        </a>
        <a href="Contact.html" class="hover-purple-glow nav-item"
           data-desc="Questions, collaboration, or support? Reach out to us.">
          Contact
        </a>
        <a href="Mission.html" class="hover-purple-glow nav-item"
           data-desc="Our mission, our values, and where we're headed next.">
          Our Mission
        </a>
      </nav>

      <!-- Expanding description panel -->
      <div id="barExplain" class="bar-explain" aria-live="polite" aria-hidden="true">
        <p class="explain-text"></p>
        <svg class="scribble-frame" viewBox="0 0 100 40" preserveAspectRatio="none" aria-hidden="true">
          <path d="M3,7 Q8,5 13,6 L87,4 Q93,5 96,8 L97,32 Q94,35 88,36 L12,35 Q6,34 3,30 Z" />
        </svg>
      </div>
    </header>

    <!-- Page Title -->
    <header style="margin-top: .5rem;">
      <h1>Magnitude Dice System</h1>

  <img src="/Images/MDS_Logo_Enh.svg" alt="MDS_Logo" class="logo" />  

      <!-- MDS section-level nav -->
      <nav class="button-bar section-nav" data-explain-target="barExplainSection">
        <a href="traits.html" class="nav-item" data-desc="Core attributes that form your dice pools.">Traits</a>
        <a href="talents.html" class="nav-item" data-desc="Specializations that make actions easier or open new angles.">Talents</a>
        <a href="abilities.html" class="nav-item" data-desc="Active powers and techniques that drive action.">Abilities</a>
        <a href="power-factors.html" class="nav-item" data-desc="The resource pools that fuel your abilities.">Power Factors</a>
        <a href="action-sequences.html" class="nav-item" data-desc="Turn flow and how big moments unfold.">Action Sequences</a>
        <a href="TheMods.html" class="nav-item" data-desc="Environmental/gear/alterations and other roll modifiers.">The Mods</a>
        <a href="CharacterCreation.html" class="nav-item" data-desc="Step-by-step guide to building your character.">Character Creation</a>
        <a href="S3_System.html" class="nav-item" data-desc="The S3 Storytelling System for structuring adventures.">S3 System</a>
      </nav>

      <div id="barExplainSection" class="bar-explain" aria-live="polite" aria-hidden="true">
        <p class="explain-text"></p>
        <svg class="scribble-frame" viewBox="0 0 100 40" preserveAspectRatio="none" aria-hidden="true">
          <path d="M3,7 Q8,5 13,6 L87,4 Q93,5 96,8 L97,32 Q94,35 88,36 L12,35 Q6,34 3,30 Z" />
        </svg>
      </div>
    </header>

    <!-- Dyslexic toggle with improved accessibility -->
    <button id="dyslexicToggle" type="button" aria-pressed="false" aria-label="Toggle dyslexic-friendly font" class="nav-btn">
      Dyslexic font
    </button>

    <section>
      <p>
        <span class="text-purple"><strong>Magnitude Dice System (MDS)</strong> is an open-license tabletop roleplaying engine built for scalable storytelling, flexible mechanics, and deeply customizable characters. At its core, MDS allows ordinary individuals to grow into legends, capable of bending the rules of reality through training, choice, and narrative consequence.<br>
        Upon debut, Paths of Power will feature the Magnitude Dice System. Explore a universe slightly altered from our own, where Sol System is thrust into a conspiracy spanning time, space and all of the Realms. This is a living breathing universe that is still reeling from an incredible upheaval.</span><br>
        <span class="text-orange">Earthlings find themselves secretly engaged with an enemy that measures calculated advancement across Eons and actively engaged against foes with millenia of experience of intrigue and war against one another.<br>
        Do you have what it takes to follow a paths to achieve unfathomable power? Or will humanity falter and fail, falling prey to the denizens of stars and realms afar.</span>
      </p>
    </section>

    <section>
      <h2>âœ¨ Traits, Talents & Abilities Define Action</h2>
      <p>
        <strong>Traits</strong> set the dice pools that characters utilize to impact every scene, while <strong>Talents</strong> shape the ease with which you engage Situations. <strong>Abilities</strong> bring the action. Imagination is the limit when you want to engage in combat, commit impossible feats, achieve invulnerability, psychic manipulation and so much more. Through the expenditures of power pools generated from <strong>Power Factors</strong>
      </p>
    </section>

    <section>
      <h2>Power Factors</h2>
      <p>Your characters in Paths of Power will utilize Power Factors to fuel abilities and action:</p>
      <ul class="power-factors">
        <li><strong>Focus</strong> â€“ Fuels extraordinary mundane feats.</li>
        <li><strong>Resonance</strong> â€“ Determines spiritual connection with the environment.</li>
        <li><strong>Phase</strong> â€“ Indicates soul alignment with the body, generating powerful Ki.</li>
        <li><strong>Psyche</strong> â€“ Reflects resistance to psychic manipulation and ability to influence others.</li>
        <li><strong>Charge</strong> â€“ Enhances cyborgs beyond all limitations.</li>
      </ul>
    </section>

    <section>
      <h2>ðŸ›  Ongoing Development</h2>
      <p>This system is evolving. As alpha testing begins, Hypermancy Studios will release supporting materials, eventually including free digital apps, adventures modules, and content toolkits. Be part of this next-level TTRPG movement from the beginning.<br>
        Special closed tests will give our playtesters the chance to play through metaplot situations that will be featured upon the First Edition release.<br>
        Stay tuned for more information.</p>
    </section>

    <a href="Index.html" class="back-link">&larr; Return to Home</a>
  </main>

  <footer>&copy; 2025 Hypermancy Studios Limited</footer>

  <!-- OPTIMIZED NAV SCRIPT: Uses event delegation and caching for better performance -->
  <script>
  (() => {
    // Cache all navs and their panels once at initialization
    const navConfigs = [];
    const allNavs = document.querySelectorAll('nav.button-bar[data-explain-target]');
    
    // Early exit if no navs exist
    if (!allNavs.length) return;

    // Build config objects with cached DOM references
    allNavs.forEach(nav => {
      const panelId = nav.getAttribute('data-explain-target');
      const panel = document.getElementById(panelId);
      if (!panel) return;

      const textEl = panel.querySelector('.explain-text');
      if (!textEl) return;

      navConfigs.push({
        nav,
        panel,
        textEl,
        hideTimer: null
      });
    });

    // Shared show/hide functions
    function showPanel(config, description) {
      // Clear any pending hide timer
      if (config.hideTimer) {
        clearTimeout(config.hideTimer);
        config.hideTimer = null;
      }
      
      config.textEl.textContent = description || '';
      config.panel.classList.add('show');
      config.panel.setAttribute('aria-hidden', 'false');
    }

    function scheduleHide(config) {
      // Clear existing timer if present
      if (config.hideTimer) {
        clearTimeout(config.hideTimer);
      }
      
      config.hideTimer = setTimeout(() => {
        config.panel.classList.remove('show');
        config.panel.setAttribute('aria-hidden', 'true');
        config.textEl.textContent = '';
        config.hideTimer = null;
      }, 120);
    }

    // Find which nav config contains the target element
    function findConfigForElement(element) {
      for (const config of navConfigs) {
        if (config.nav.contains(element)) {
          return config;
        }
      }
      return null;
    }

    // Single delegated mouseover handler for all navs
    document.addEventListener('mouseover', (e) => {
      const link = e.target.closest('a[href]');
      if (!link) return;

      const config = findConfigForElement(link);
      if (!config) return;

      const desc = link.dataset.desc || link.title || link.textContent.trim();
      showPanel(config, desc);
    }, { passive: true });

    // Single delegated focusin handler for all navs
    document.addEventListener('focusin', (e) => {
      const link = e.target.closest('a[href]');
      if (!link) return;

      const config = findConfigForElement(link);
      if (!config) return;

      const desc = link.dataset.desc || link.title || link.textContent.trim();
      showPanel(config, desc);
    }, { passive: true });

    // Single delegated mouseout handler
    document.addEventListener('mouseout', (e) => {
      const from = e.target.closest('a[href]');
      if (!from) return;

      const config = findConfigForElement(from);
      if (!config) return;

      const to = e.relatedTarget;
      // Only hide if we're leaving the nav entirely
      if (!to || !config.nav.contains(to)) {
        scheduleHide(config);
      }
    }, { passive: true });

    // Single delegated focusout handler
    document.addEventListener('focusout', (e) => {
      const from = e.target.closest('a[href]');
      if (!from) return;

      const config = findConfigForElement(from);
      if (!config) return;

      // Short delay to check if focus moved within same nav
      setTimeout(() => {
        if (!config.nav.contains(document.activeElement)) {
          scheduleHide(config);
        }
      }, 0);
    }, { passive: true });

    // Global escape key handler
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        navConfigs.forEach(config => scheduleHide(config));
      }
    });
  })();
  </script>
</body>
</html>
